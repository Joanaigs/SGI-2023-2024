<?xml version="1.0" encoding="UTF-16" standalone="yes"?>
<yaf>

    <globals background="0 0 0 1" ambient="1 1 1 1" />

    <fog color="0.565 0.635 0.682 0.2" near="3000" far="5000.0" />

    <skybox size="2000 500 2000" center="0 240 0" emissive="0.59 0.24 0.62 1.0" intensity="4.0"
        up="textures/up.jpg" down="textures/dn.jpg"
        left="textures/lf.jpg" right="textures/rt.jpg"
        front="textures/ft.jpg" back="textures/bk.jpg" />


    <cameras initial="main">
        <perspective id="main" angle="1.047" near="0.1" far="5000" location="100 700 200"
            target="100 0 200" />
        <perspective id="playerGarage" angle="1.047" near="0.1" far="5000"
            location="-2510 175 -2758"
            target="-2489 162 -2353" />
        <perspective id="car" angle="1.26" near="0.1" far="5000" location="400 10 300"
            target="75 0 300" />
        <perspective id="followCar" angle="1.047" near="0.1" far="5000" location="310 20 100"
            target="310 0 150" />
        <perspective id="frontHouse" angle="1.047" near="0.1" far="5000" location="130 10 -25"
            target="50 10 -25" />
        <perspective id="playerGarage2" angle="1.1" near="0.01" far="2000"
            location="-2510 175 -2758"
            target="-2489 162 -2353" />
        <perspective id="menu" angle="1.047" near="0.1" far="5000" location="-1971 249 -2510"
            target="-1971 249 -2500" />
        <perspective id="origin" angle="1.047" near="0.1" far="5000" location="5 5 5"
            target="0 0 0" />
        <perspective id="pickObstacles" angle="1.047" near="0.1" far="5000" location="-127 376 261"
            target="41 57 272" />
         <perspective id="final" angle="1.0" near="0.1" far="5000" location="-1973 242 -2950"
            target="-1971 242 -3000" />
    </cameras>

    <!-- bloco de texturas. Este bloco tem de existir mas pode estar vazio, se nao forem usadas
    texturas -->
    <textures>
        <texture id="candycaneTex" filepath="textures/candycane.png" />
        <texture id="coneTex" filepath="textures/cone.jpg" />
        <texture id="coneBumpTex" filepath="textures/cone_bump.jpg" />
        <texture id="icecreamTex" filepath="textures/icecream.jpg" />
        <texture id="icecreamBumpTex" filepath="textures/icecream_bump.jpg" />
        <texture id="icecreamSpecTex" filepath="textures/icecream_specular.jpg" />
        <texture id="cookieTex" filepath="textures/cookie.jpg" />

    </textures>

    <materials>

        <material id="candycaneApp" emissive="0.0 0.0 0.0 1" color="1 1 1 1.0"
            specular="1 1 1 1" shininess="30" textureref="candycaneTex" texlength_s="0.2"
            texlength_t="10" twosided="true" />
        <material id="coneApp" emissive="0.0 0.0 0.0 1" color="1 1 1 1.0"
            specular="1 1 1 1" shininess="30" textureref="coneTex" bumpref="coneBumpTex"
            bumpscale="0.5"
            texlength_s="4" texlength_t="4" />
        <material id="icecreamApp" emissive="0.0 0.0 0.0 1" color="1 1 1 1.0"
            specular="1 1 1 1" shininess="30" textureref="icecreamTex" bumpref="icecreamBumpTex"
            bumpscale="1"
            specularref="icecreamSpecTex" texlength_s="5" texlength_t="5" />
        <material id="whiteApp" emissive="0.0 0.0 0.0 1" color="1 1 1 1.0"
            specular="1 1 1 1" shininess="0" />
        <material id="chupachupaRedApp" emissive="0.0 0.0 0.0 1" color="1 0.33 0.33 0.95"
            specular="1 1 1 1" shininess="50" />
        <material id="lolipopPinkShaderApp" emissive="0.0 0.0 0.0 1" color="1.0 0.75 0.8 0.95"
            specular="1 1 1 1" shininess="50" shaderfrag="shaders/lolipop.frag"
            shadervert="shaders/lolipop.vert"
            shaderuniforms="heightMap sampler2D textures/lolipop_heightmap.jpg" />
        <material id="lolipopPinkApp" emissive="0.0 0.0 0.0 1" color="1.0 0.75 0.8 0.95"
            specular="1 1 1 1" shininess="0" />
        <material id="cookieApp" emissive="0.0 0.0 0.0 1" color="1 1 1 1.0" specular="0 0 0 1"
            shininess="0" textureref="cookieTex" texlength_s="30" texlength_t="30" twosided="true" />

    </materials>

    <graph rootid="scene">

        <node id="scene">
            <children>


                <pointlight id="sun" enabled="true"
                    color="1 1 1 0"
                    intensity="500"
                    distance="0"
                    decay="1"
                    position="120 80 1.047"
                />

                <directionallight id="light5" enabled="true" 
                color="1.0 1.0 1.0 1" 
                intensity="3"
                castshadow="true"
                position="500 200 -300" 
                shadowfar="2000"
                shadowmapsize="128"
                shadowleft="-1000"
                shadowright="1000"
                shadowtop="1000"
                shadowbottom="-1000"
            /> 

                <pointlight id="garageSun" enabled="true"
                    color="1 1 1 0"
                    intensity="500"
                    distance="0"
                    decay="1"
                    position="-2500 300 -2600"
                    shadowfar="500"
                    castshadow="true"
                    shadowmapsize="256"
                />

                <pointlight id="final" enabled="true"
                    color="1 1 1 0"
                    intensity="300"
                    distance="100"
                    decay="1"
                    position="-2500 300 -3000"
                />

                <noderef id="candycane" />
                <noderef id="canycane2" />
                <noderef id="canycane3" />
                <noderef id="icecream" />
                <noderef id="chupachupa" />
                <noderef id="lolipop" />
                <noderef id="candycaneGarage" />
                <noderef id="candycaneGarage2" />
                <noderef id="candycaneGarage3" />
                <noderef id="candycaneGarage4" />
                <noderef id="cookie" />


            </children>
        </node>

        <!-- Candy canes -->
        <node id="fullCandyCane" castshadows="true">

            <transforms>
                <scale value3="200 200 200" />
            </transforms>

            <materialref id="candycaneApp" />

            <children>
                <noderef id="candyCaneStructure1" />
                <noderef id="candyCaneStructure2" />
                <noderef id="candyCaneStructure" />
                <noderef id="candyCaneStructureReverse" />
            </children>
        </node>

        <node id="candyCaneStructureReverse">

            <materialref id="candycaneApp" />

            <children>
                <primitive>
                    <nurbs degree_u="5" degree_v="3" parts_u="20" parts_v="20">
                        <controlpoint xx="-0.1" yy="-1" zz="0" />
                        <controlpoint xx="-0.1" yy="-1" zz="0.13" />
                        <controlpoint xx="0.1" yy="-1" zz="0.13" />
                        <controlpoint xx="0.1" yy="-1" zz="0" />

                        <controlpoint xx="-0.1" yy="0" zz="0" />
                        <controlpoint xx="-0.1" yy="0" zz="0.13" />
                        <controlpoint xx="0.1" yy="0" zz="0.13" />
                        <controlpoint xx="0.1" yy="0" zz="0" />

                        <controlpoint xx="0" yy="0.15" zz="0" />
                        <controlpoint xx="0" yy="0.15" zz="0.2" />
                        <controlpoint xx="0" yy="-0.15" zz="0.2" />
                        <controlpoint xx="0" yy="-0.15" zz="0" />

                        <controlpoint xx="0.4" yy="0.15" zz="0" />
                        <controlpoint xx="0.4" yy="0.15" zz="0.2" />
                        <controlpoint xx="0.4" yy="-0.15" zz="0.2" />
                        <controlpoint xx="0.4" yy="-0.15" zz="0" />

                        <controlpoint xx="0.5" yy="-0.3" zz="0" />
                        <controlpoint xx="0.5" yy="-0.3" zz="0.13" />
                        <controlpoint xx="0.3" yy="-0.3" zz="0.13" />
                        <controlpoint xx="0.3" yy="-0.3" zz="0" />

                        <controlpoint xx="0.5" yy="-0.5" zz="0" />
                        <controlpoint xx="0.5" yy="-0.5" zz="0.13" />
                        <controlpoint xx="0.3" yy="-0.5" zz="0.13" />
                        <controlpoint xx="0.3" yy="-0.5" zz="0" />
                    </nurbs>
                </primitive>
            </children>
        </node>


        <node id="candyCaneStructure">

            <materialref id="candycaneApp" />

            <children>
                <primitive>
                    <nurbs degree_u="5" degree_v="3" parts_u="20" parts_v="20">
                        <controlpoint xx="-0.1" yy="-1" zz="0" />
                        <controlpoint xx="-0.1" yy="-1" zz="-0.13" />
                        <controlpoint xx="0.1" yy="-1" zz="-0.13" />
                        <controlpoint xx="0.1" yy="-1" zz="0" />

                        <controlpoint xx="-0.1" yy="0" zz="0" />
                        <controlpoint xx="-0.1" yy="0" zz="-0.13" />
                        <controlpoint xx="0.1" yy="0" zz="-0.13" />
                        <controlpoint xx="0.1" yy="0" zz="0" />

                        <controlpoint xx="0" yy="0.15" zz="0" />
                        <controlpoint xx="0" yy="0.15" zz="-0.2" />
                        <controlpoint xx="0" yy="-0.15" zz="-0.2" />
                        <controlpoint xx="0" yy="-0.15" zz="0" />

                        <controlpoint xx="0.4" yy="0.15" zz="0" />
                        <controlpoint xx="0.4" yy="0.15" zz="-0.2" />
                        <controlpoint xx="0.4" yy="-0.15" zz="-0.2" />
                        <controlpoint xx="0.4" yy="-0.15" zz="0" />

                        <controlpoint xx="0.5" yy="-0.3" zz="0" />
                        <controlpoint xx="0.5" yy="-0.3" zz="-0.13" />
                        <controlpoint xx="0.3" yy="-0.3" zz="-0.13" />
                        <controlpoint xx="0.3" yy="-0.3" zz="0" />

                        <controlpoint xx="0.5" yy="-0.5" zz="0" />
                        <controlpoint xx="0.5" yy="-0.5" zz="-0.13" />
                        <controlpoint xx="0.3" yy="-0.5" zz="-0.13" />
                        <controlpoint xx="0.3" yy="-0.5" zz="0" />
                    </nurbs>
                </primitive>
            </children>

        </node>

        <node id="candyCaneStructure1">

            <transforms>
                <translate value3="0 -1 0" />
            </transforms>

            <materialref id="candycaneApp" />

            <children>
                <primitive>
                    <cylinder base="0.1" top="0.1" height="0.01" slices="32" stacks="1"
                        capsclose="true" />

                </primitive>
            </children>

        </node>

        <node id="candyCaneStructure2">

            <transforms>
                <translate value3="0.4 -0.5 0" />
            </transforms>

            <materialref id="candycaneApp" />

            <children>
                <primitive>
                    <cylinder base="0.1" top="0.1" height="0.01" slices="32" stacks="1"
                        capsclose="true" />
                </primitive>
            </children>

        </node>


        <node id="candycaneGarage">
            <transforms>
                <translate value3="-2350 190 -2500" />
                <rotate value3="0.0 3.14 0.0" />
                <scale value3="0.3 0.3 0.3" />
            </transforms>

            <children>
                <noderef id="fullCandyCane" />
            </children>
        </node>

        <node id="candycaneGarage4">
            <transforms>
                <translate value3="-2330 190 -2500" />
                <scale value3="0.3 0.3 0.3" />
            </transforms>

            <children>
                <noderef id="fullCandyCane" />
            </children>
        </node>


        <node id="candycaneGarage2" >
            <transforms>
                <translate value3="-2650 190 -2500" />
                <scale value3="0.3 0.3 0.3" />
            </transforms>

            <children>
                <noderef id="fullCandyCane" />
            </children>
        </node>

        <node id="candycaneGarage3" >
            <transforms>
                <translate value3="-2670 190 -2500" />
                <rotate value3="0.0 3.14 0.0" />
                <scale value3="0.3 0.3 0.3" />
            </transforms>

            <children>
                <noderef id="fullCandyCane" />
            </children>
        </node>

        <!-- Icecream -->


        <node id="icecreamObject">


            <children>
                <noderef id="icecreamCone" />
                <noderef id="icecreamBall1" />
                <noderef id="icecreamBall2" />
                <noderef id="icecreamBall3" />
            </children>

        </node>


        <node id="icecreamCone">
            <transforms>
                <rotate value3="0 0 1.30" />
            </transforms>

            <materialref id="coneApp" />

            <children>
                <primitive>
                    <cylinder base="0" top="1.5" height="4" slices="32" stacks="1"
                        capsclose="true" />
                </primitive>

            </children>
        </node>

        <node id="icecreamBallBottom">
            <transforms>
                <scale value3="1 0.4 1" />
            </transforms>


            <children>
                <primitive>
                    <sphere radius="2.5" slices="32" stacks="32" />
                </primitive>
            </children>
        </node>

        <node id="icecreamBallTop">
            <transforms>
                <translate value3="0 1 0" />
            </transforms>

            <children>
                <primitive>
                    <sphere radius="2" slices="32" stacks="32" />
                </primitive>
            </children>
        </node>


        <node id="icecreamBallFirst">


            <children>
                <noderef id="icecreamBallBottom" />
                <noderef id="icecreamBallTop" />
            </children>
        </node>

        <node id="icecreamBallSecond">


            <children>
                <noderef id="icecreamBallTop" />
            </children>

        </node>

        <lod id="icecreamBall">
            <children>
                <noderef id="icecreamBallFirst" mindist="0" />
                <noderef id="icecreamBallSecond" mindist="800" />
            </children>
        </lod>

        <node id="icecreamBall1">
            <transforms>
                <translate value3="-2.5 0.75 0" />
                <rotate value3="0 0 1.3" />
                <scale value3="0.8 0.8 0.8" />
            </transforms>

            <materialref id="icecreamApp" />

            <children>
                <lodref id="icecreamBall" />
            </children>
        </node>

        <node id="icecreamBall2">
            <transforms>
                <translate value3="-5.5 1 0" />
                <rotate value3="0 0 0.9" />
                <scale value3="0.6 0.6 0.6" />
            </transforms>

            <materialref id="icecreamApp" />


            <children>
                <lodref id="icecreamBall" />
            </children>
        </node>

        <node id="icecreamBall3">
            <transforms>
                <translate value3="-9 0 0" />
                <rotate value3="0 0 0" />
                <scale value3="0.4 0.4 0.4" />
            </transforms>

            <materialref id="icecreamApp" />

            <children>
                <lodref id="icecreamBall" />
            </children>
        </node>

        <!-- ChupaChupa-->
        <node id="chupachupaFirst">


            <materialref id="chupachupaRedApp" />

            <children>
                <noderef id="chupachupaTop" />
                <noderef id="chupachupaTopCircle" />
                <noderef id="chupachupaBottom" />
            </children>
        </node>

        <node id="chupachupaSecond">


            <materialref id="chupachupaRedApp" />

            <children>
                <noderef id="chupachupaTop" />
                <noderef id="chupachupaBottom" />
            </children>
        </node>

        <lod id="chupachupalod">
            <children>
                <noderef id="chupachupaFirst" mindist="0" />
                <noderef id="chupachupaSecond" mindist="1000" />
            </children>
        </lod>


        <node id="chupachupaTop">
            <transforms>
                <translate value3="0 5.25 0" />
            </transforms>


            <children>
                <primitive>
                    <sphere radius="1.5" slices="32" stacks="32" />
                </primitive>
            </children>
        </node>

        <node id="chupachupaTopCircle">
            <transforms>
                <translate value3="0 5.25 0" />

            </transforms>


            <children>
                <primitive>
                    <cylinder base="1.65" top="1.65" height="0.5" slices="32" stacks="1"
                        capsclose="true" />
                </primitive>
            </children>
        </node>

        <node id="chupachupaBottom">
            <transforms>
                <translate value3="0 2 0" />
            </transforms>

            <materialref id="whiteApp" />

            <children>
                <primitive>
                    <cylinder base="0.3" top="0.3" height="5" slices="32" stacks="1"
                        capsclose="true" />
                </primitive>
            </children>
        </node>

        <!-- Lolipops-->

        <node id="lolipopObject">

            <children>
                <noderef id="lolipopTop" />
                <noderef id="lolipopBottom" />
            </children>
        </node>

        <node id="lolipopTop">
            <transforms>
                <translate value3="0 5.25 0" />
                <scale value3="1 1 0.5" />
            </transforms>

            <materialref id="lolipopPinkShaderApp" />

            <children>
                <primitive>
                    <sphere radius="1.5" slices="32" stacks="32" />
                </primitive>
            </children>
        </node>


        <node id="lolipopBottom">
            <transforms>
                <translate value3="0 2 0" />
            </transforms>

            <materialref id="whiteApp" />

            <children>
                <primitive>
                    <cylinder base="0.3" top="0.3" height="5" slices="32" stacks="1"
                        capsclose="true" />
                </primitive>
            </children>
        </node>

        <!--Outside
        Ring-->

        <node id="lolipop">
            <transforms>
                <translate value3="800 15 600" />
                <rotate value3="0 1.54 0" />
                <scale value3="20 20 20" />
            </transforms>

            <children>
                <noderef id="lolipopObject" />
            </children>
        </node>

        <node id="chupachupa">
            <transforms>
                <translate value3="-300 20 200" />
                <rotate value3="0 0 0" />
                <scale value3="20 20 20" />
            </transforms>

            <children>
                <lodref id="chupachupalod" />
            </children>
        </node>

        <node id="icecream" castshadows="true">

            <transforms>
                <translate value3="-25 0 600" />
                <rotate value3="0 -1.54 0" />
                <scale value3="20 20 20" />
            </transforms>

            <children>
                <noderef id="icecreamObject" />
            </children>

        </node>

        <node id="candycane">
            <transforms>
                <translate value3="-500 150 700" />
                <rotate value3="0 -1 0" />
                <scale value3="0.8 0.8 0.8" />

    

            </transforms>

            <children>
                <noderef id="fullCandyCane" />
            </children>
        </node>

        <node id="canycane2">
            <transforms>
                <translate value3="450 160 -750" />
                <rotate value3="0 2.0 0" />
                <scale value3="0.8 0.8 0.8" />


            </transforms>

            <children>
                <noderef id="fullCandyCane" />
            </children>
        </node>

        <node id="canycane3">
            <transforms>
                <translate value3="500 160 -650" />
                <rotate value3="0 -1.0 0" />
                <scale value3="0.8 0.8 0.8" />



            </transforms>

            <children>
                <noderef id="fullCandyCane" />
            </children>
        </node>

        <node id="cookie" castshadows="true">
            <transforms>
                <translate value3="20 20 -20" />
                <rotate value3="1.54 -0.1 0" />
                <rotate value3="1 0 0" />

                <scale value3="10 10 10" />
            </transforms>

            <materialref id="cookieApp" />

            <children>
                <primitive>
                    <cylinder base="10" top="10" height="0.1" slices="32" stacks="1"
                        capsclose="true" />
                </primitive>
            </children>

        </node>

        




    </graph>
</yaf> 